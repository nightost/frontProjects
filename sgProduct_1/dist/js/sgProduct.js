/* Copyright (c) 2014*/ 
/*Nightost; Licensed MIT */
function sgProduct(a){function b(){v=$(".cover"),w=$(".catelog"),x=$(".pageBox"),A=$(".pages .page"),B=$(".catelog .list li .sn"),G=B.length,C=$(".cup"),D=$(".favPage"),E=A.length}function c(){setTimeout(function(){-1*v.width();v.css({"-webkit-transform":"rotateY(-90deg)","-moz-transform":"rotateY(-90deg)","-o-transform":"rotateY(-90deg)",transform:"rotateY(-90deg)"}),g()},I),y=new Hammer.Manager(x[0],{domEvents:!0,touchAction:"pan-y"}),y.add(new Hammer.Swipe({pointers:1,distance:3,velocity:.1})),y.on("swipeleft",e),y.on("swiperight",f),B.each(function(a){var b=a;$(this).bind("click",function(){var a=o(b,!0);u(b),a&&q(!1)})}),x.bind("touchstart",function(a){"go-detail"!=a.target.className&&L.bottomBar&&L.bottomBar.setProgress(!0)}),x.bind("touchend",function(){L.bottomBar&&L.bottomBar.setTime()}),z=new Hammer.Manager(w[0],{domEvents:!0,touchAction:"pan-y"}),z.add(new Hammer.Swipe({pointers:1,distance:3,velocity:.1})),z.on("swipeleft",d)}function d(){var a=o(0,!0);a&&(q(!1),i())}function e(){3==K&&s(!1);var a=K+1;o(a,!0,"left")}function f(){switch(K){case 0:var a=K-1;return o(a,!0,"right"),h(),void j();case 3:s(!1);var a=K-1;o(a,!0,"right");break;default:var a=K-1;o(a,!0,"right")}}function g(){var a=w.find(".title-content");a.addClass("c-rotate"),j(),h()}function h(){F||(F=setInterval(function(){B.eq(M).find("span").removeClass("spanHover");var a=M+1;a=a>G-1?0:a,M=a,B.eq(M).find("span").addClass("spanHover")},J))}function i(){F&&(F=clearInterval(F))}function j(){var a=$(".item-img1"),b=$(".item-img2");a.addClass("item-img1Active"),b.addClass("item-img2Active")}function k(){var a=$(".item-img1"),b=$(".item-img2");a.removeClass("item-img1Active"),b.removeClass("item-img2Active")}function l(a,b,c,d){var e=1==c?0:-90;0!=b&&n(a,b);var f=e+"deg";a.animate({rotateY:f},500,"ease-in",function(){-1!=d?A.eq(d).css("display","none"):-1==d&&w.css("display","none")})}function m(a,b,c){var d=c;0!=b&&n(a,b),a.css({"-webkit-transform":"rotateY("+d+"deg)","-moz-transform":"rotateY("+d+"deg)","-o-transform":"rotateY("+d+"deg)",transform:"rotateY("+d+"deg)"})}function n(a,b){var c="bottom center";switch(b){case 1:c="top center";break;case 2:c="center right";break;case 3:c="bottom center";break;case 4:c="center left"}a.css({"-webkit-transform-origen":b,"-moz-transform-origen":b,"-o-transform-origen":b,"transform-origen":b})}function o(a,b,c){var d=b,e=A.eq(K),f=$(A.get(a));return-1==K?(f.css("display","block"),l(w,0,0,K),d&&t(a),p(f),K=a,!0):-1==a?(w.css("display","block"),l(w,0,1,K),K=a,!0):0==f.length?!1:(d&&t(a),3==a&&s(!0),f.css("display","block"),setTimeout(function(){"left"==c?l(e,0,0,K):"right"==c?l(f,0,1,K):l(w,0,0,K),K=a,p(f)},0),!0)}function p(a){a.find(".go-detail").toggleClass("go-detail-hover")}function q(a){a?j():k()}function r(){$(A.get(K)).css("display","none")}function s(a){setTimeout(function(){C.find(".text p").each(a?function(){$(this).css("opacity",1)}:function(){$(this).css("opacity",0)})},600)}function t(a){var b=a/(E-1);L.bottomBar&&L.bottomBar.setProgressBtn(b)}function u(a){l(w,0,0,-1),A.each(function(b){a>b&&l($(this),0,0,b)}),w.css("display","block")}var v,w,x,y,z,A,B,C,D,E,F,G,H=a||{},I=H.indexTime||3e3,J=H.catelogTime||2e3,K=-1,L=this,M=0;!function(){b(),c()}(),this.startcateLogRoll=function(){h()},this.showcEffect=function(){j()},this.showCatelog=function(){l(w,0,1),r(),this.recoveryAll()},this.setFavBox=function(a){a?(m(D,2,0),L.bottomBar&&L.bottomBar.setFavBtn(!1)):(m(D,2,90),L.bottomBar&&L.bottomBar.setFavBtn(!0))},this.slidePage=function(a){var b,c=Math.ceil(a*(E-1));if(K>c)b="right";else{if(!(c>K))return;b="left"}o(c,!1,b)},this.recoveryAll=function(){A.each(function(a){l($(this),0,1,a)}),w.css("display","block"),l(w,0,1),K=-1}}function bottomBar(a){function b(){g=$(".bottomBar .homeBtn"),h=$(".bottomBar .fav"),i=$(".bottomBar .progress .btn"),k=$(".bottomBar .progress"),o=$(".bottomBar .middle"),p=$(".bottomBar")}function c(){n=k.offset().width;var a=i.offset().width,b=Math.floor(a/2);l=n-b,m=-b,d()}function d(){var a=w*l;0==a&&(a=m),i.css("left",a)}function e(){j=new Hammer.Manager(i[0]),j.add(new Hammer.Pan({threshold:2,pointers:0})),j.on("pan",f),j.on("hammer.input",function(a){a.isFinal&&(s=0,u.setTime())}),g.bind("click",function(){return v?(r.setFavBox(!1),void(v=!1)):(r.showCatelog(),r.showcEffect(),void r.startcateLogRoll())}),p.on("touchstart",function(){null!=q&&clearTimeout(q)}),p.on("touchend",function(){u.setTime()}),h.on("click",function(){r.setFavBox(!0),u.setFavBtn(!1),v=!0,u.setProgress(!1)})}function f(a){null!=q&&clearTimeout(q);var b=parseInt(i.css("left")),c=a.deltaX-s,d=b+c;if(!(m>d||d>l)){var e=b+c;i.css("left",d),s=a.deltaX;var f=e/l;r.slidePage(f)}}var g,h,i,j,k,l,m,n,o,p,q,r=a,s=0,t=!1,u=this,v=!1,w=0;!function(){b(),e()}(),this.setFavBtn=function(a){a?h.show():h.hide()},this.setProgress=function(a){a&&clearTimeout(q),a&&!t?(o.show(),p.css("background","rgba(0,0,0,.6)"),t=!0,c()):!a&&t&&(o.hide(),p.css("background","none"),t=!1)},this.setTime=function(){t&&(q=setTimeout(function(){o.hide(),p.css("background","none"),t=!1},4e3))},this.setProgressBtn=function(a){w=a,l&&d()}}function setSiderBar(){function a(a){e.find(".pimg img").attr("src",data[a].imgSrc),e.find(".ptitle").text(data[a].title),e.find(".pprice i").text(data[a].price),e.find(".ptext .dis").html(data[a].activity),e.find(".ptext .feature").html(data[a].detail)}function b(){e=$(".rightSlider"),f=$(".rightSlider .detailConent"),g=$(".go-detail"),h=$(".rightSlider .closeBtn")}function c(){g.bind("click",function(){var b=$(this).attr("data-key");a(b),d(!0),i=!0}),h.bind("click",function(){d(!1),i=!1}),e.bind("click",function(a){i&&"addFav"!=a.target.className&&(d(!1),i=!1)})}function d(a){if(a)e.css("display","block"),setTimeout(function(){f.css("right",0)},0);else{var b=-1*f.offset().width;f.css("right",b),setTimeout(function(){e.css("display","none")},500)}}var e,f,g,h,i;!function(){b(),c()}()}$(function(){var a=new sgProduct,b=new bottomBar(a);a.bottomBar=b;var c=new setSiderBar;a.siderBar=c});